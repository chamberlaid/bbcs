<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>asteroid tracker</title>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600&display=swap');

    :root{
      --bg:#05070b;
      --panel:rgba(8,12,18,.72);
      --panel2:rgba(10,16,24,.48);
      --line:rgba(120,180,255,.18);
      --text:rgba(230,240,255,.92);
      --muted:rgba(230,240,255,.58);
      --accent:rgba(120,180,255,.95);
      --warn:rgba(255,170,90,.95);
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      background: radial-gradient(1200px 700px at 50% 40%, rgba(45,80,130,.18), transparent 60%),
                  radial-gradient(900px 500px at 20% 20%, rgba(120,180,255,.12), transparent 60%),
                  var(--bg);
      color:var(--text);
      font-family:'Outfit', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      text-transform:lowercase;
      overflow:hidden;
    }

    .scanlines{
      pointer-events:none;
      position:fixed; inset:0;
      background:
        linear-gradient(to bottom, rgba(255,255,255,.05), rgba(255,255,255,0)) 0 0/100% 3px,
        radial-gradient(900px 600px at 50% 40%, rgba(120,180,255,.06), transparent 65%);
      mix-blend-mode:overlay;
      opacity:.25;
    }

    .grid{
      pointer-events:none;
      position:fixed; inset:-20%;
      background-image:
        linear-gradient(to right, rgba(120,180,255,.06) 1px, transparent 1px),
        linear-gradient(to bottom, rgba(120,180,255,.06) 1px, transparent 1px);
      background-size: 64px 64px;
      transform: rotate(-8deg);
      opacity:.22;
      mask-image: radial-gradient(closest-side at 50% 45%, rgba(0,0,0,1), rgba(0,0,0,0));
    }

    #app{
      position:fixed; inset:0;
      display:grid;
      grid-template-columns: 360px 1fr 360px;
      grid-template-rows: 84px 1fr 120px;
      gap:14px;
      padding:14px;
    }

    .panel{
      background:var(--panel);
      border:1px solid var(--line);
      border-radius:16px;
      box-shadow: 0 10px 30px rgba(0,0,0,.35);
      overflow:hidden;
      backdrop-filter: blur(10px);
    }

    .topbar{
      grid-column:1/-1;
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:14px 16px;
    }

    .brand{
      display:flex; flex-direction:column; gap:2px;
    }
    .brand .title{
      letter-spacing:.08em;
      font-weight:600;
      font-size:14px;
      color:var(--text);
    }
    .brand .sub{
      font-size:12px;
      color:var(--muted);
      letter-spacing:.06em;
    }

    .status{
      display:flex; align-items:center; gap:10px;
      font-size:12px; color:var(--muted);
    }
    .dot{
      width:10px; height:10px; border-radius:999px;
      background:var(--accent);
      box-shadow: 0 0 18px rgba(120,180,255,.9);
    }

    .left{ grid-column:1; grid-row:2; display:flex; flex-direction:column; }
    .right{ grid-column:3; grid-row:2; display:flex; flex-direction:column; }
    .bottom{
      grid-column:1/-1; grid-row:3;
      display:flex; align-items:center; justify-content:space-between;
      padding:14px 16px;
      gap:14px;
    }

    .panelHeader{
      padding:14px 16px;
      border-bottom:1px solid var(--line);
      background:linear-gradient(to bottom, rgba(120,180,255,.08), transparent);
    }
    .panelHeader h2{
      margin:0;
      font-size:12px;
      letter-spacing:.14em;
      color:var(--muted);
      font-weight:600;
    }

    .panelBody{
      padding:14px 16px;
      display:flex;
      flex-direction:column;
      gap:12px;
    }

    .kpiRow{ display:flex; gap:10px; }
    .kpi{
      flex:1;
      padding:12px 12px;
      border:1px solid var(--line);
      border-radius:14px;
      background:var(--panel2);
    }
    .kpi .label{ font-size:11px; color:var(--muted); letter-spacing:.08em; }
    .kpi .value{ margin-top:6px; font-size:18px; font-weight:600; color:var(--text); }
    .kpi .hint{ margin-top:4px; font-size:11px; color:var(--muted); }

    .list{
      border:1px solid var(--line);
      border-radius:14px;
      overflow:hidden;
      background:rgba(10,16,24,.35);
    }
    .row{
      display:flex; align-items:center; justify-content:space-between;
      padding:10px 12px;
      border-bottom:1px solid rgba(120,180,255,.12);
      font-size:12px;
      color:var(--muted);
    }
    .row:last-child{ border-bottom:none; }
    .badge{
      padding:4px 8px;
      border-radius:999px;
      border:1px solid rgba(120,180,255,.25);
      background:rgba(120,180,255,.08);
      color:rgba(220,235,255,.9);
      letter-spacing:.06em;
      font-size:11px;
    }
    .badge.warn{
      border-color: rgba(255,170,90,.35);
      background: rgba(255,170,90,.10);
      color: rgba(255,210,170,.95);
    }

    .centerStage{
      grid-column:2; grid-row:2;
      position:relative;
      border-radius:18px;
      overflow:hidden;
      border:1px solid var(--line);
      background: radial-gradient(1200px 700px at 50% 50%, rgba(120,180,255,.06), transparent 60%);
    }
    canvas{ display:block; width:100%; height:100%; }

    .hud{
      position:absolute; inset:0;
      pointer-events:none;
    }

    .hud .reticle{
      position:absolute;
      left:50%; top:50%;
      transform:translate(-50%,-50%);
      width:240px; height:240px;
      border:1px dashed rgba(120,180,255,.22);
      border-radius:999px;
      box-shadow: inset 0 0 40px rgba(120,180,255,.08);
    }
    .hud .reticle:before, .hud .reticle:after{
      content:"";
      position:absolute; inset:18px;
      border:1px solid rgba(120,180,255,.10);
      border-radius:999px;
    }
    .hud .reticle:after{
      inset:52px;
      border-color: rgba(120,180,255,.08);
    }

    .hoverCard{
      position:absolute;
      left:16px; bottom:16px;
      width:min(360px, calc(100% - 32px));
      background:rgba(8,12,18,.78);
      border:1px solid var(--line);
      border-radius:16px;
      padding:12px 12px;
      backdrop-filter: blur(10px);
      pointer-events:none;
      transform: translateY(8px);
      opacity:0;
      transition: opacity .18s ease, transform .18s ease;
    }
    .hoverCard.show{
      opacity:1;
      transform: translateY(0);
    }
    .hoverCard .name{
      font-weight:600; color:var(--text);
      letter-spacing:.08em;
      font-size:12px;
    }
    .hoverCard .meta{
      margin-top:6px;
      display:flex; gap:8px; flex-wrap:wrap;
      font-size:11px;
      color:var(--muted);
    }
    .hoverCard .meta span{
      padding:4px 8px;
      border-radius:999px;
      border:1px solid rgba(120,180,255,.18);
      background: rgba(120,180,255,.06);
    }

    .legend{
      display:flex; gap:10px; align-items:center; flex-wrap:wrap;
      font-size:12px;
      color:var(--muted);
    }
    .key{
      display:flex; gap:8px; align-items:center;
      padding:8px 10px;
      border:1px solid var(--line);
      border-radius:999px;
      background:rgba(10,16,24,.35);
    }
    .swatch{
      width:10px; height:10px; border-radius:999px;
      background:var(--accent);
      box-shadow:0 0 16px rgba(120,180,255,.75);
    }
    .swatch.warn{ background:var(--warn); box-shadow:0 0 16px rgba(255,170,90,.75); }

    .hintbar{
      display:flex; align-items:center; justify-content:flex-end; gap:10px;
      font-size:12px; color:var(--muted);
      white-space:nowrap;
    }

    a, button{ font-family:inherit; text-transform:lowercase; }
    .small{
      font-size:11px;
      letter-spacing:.08em;
      color:var(--muted);
    }
  </style>
</head>

<body>
  <div class="grid"></div>
  <div class="scanlines"></div>

  <div id="app">
    <div class="panel topbar">
      <div class="brand">
        <div class="title">near-earth object tracker</div>
        <div class="sub">live orbital solutions • simulation mode</div>
      </div>
      <div class="status">
        <div class="dot"></div>
        <div>tracking online</div>
        <div class="small">|</div>
        <div id="clock">00:00:00</div>
      </div>
    </div>

    <div class="panel left">
      <div class="panelHeader"><h2>telemetry</h2></div>
      <div class="panelBody">
        <div class="kpiRow">
          <div class="kpi">
            <div class="label">objects</div>
            <div class="value" id="kpiObjects">—</div>
            <div class="hint">active returns</div>
          </div>
          <div class="kpi">
            <div class="label">hover lock</div>
            <div class="value" id="kpiLock">none</div>
            <div class="hint">ray contact</div>
          </div>
        </div>

        <div class="list" id="objectList"></div>
      </div>
    </div>

    <div class="centerStage" id="stage">
      <canvas id="c"></canvas>

      <div class="hud">
        <div class="reticle"></div>

        <div class="hoverCard" id="hoverCard">
          <div class="name" id="hoverName">object</div>
          <div class="meta" id="hoverMeta"></div>
        </div>
      </div>
    </div>

    <div class="panel right">
      <div class="panelHeader"><h2>system</h2></div>
      <div class="panelBody">
        <div class="kpi">
          <div class="label">scan state</div>
          <div class="value" id="scanState">sweep</div>
          <div class="hint">passive detection • hover to amplify</div>
        </div>

        <div class="list">
          <div class="row"><div>render</div><div class="badge">lightweight</div></div>
          <div class="row"><div>models</div><div class="badge">built-in</div></div>
          <div class="row"><div>hover effects</div><div class="badge warn">enabled</div></div>
          <div class="row"><div>click routing</div><div class="badge">pages</div></div>
        </div>

        <div class="small">tip: hover an asteroid to reveal its record. click to open its destination.</div>
      </div>
    </div>

    <div class="panel bottom">
      <div class="legend">
        <div class="key"><span class="swatch"></span> tracked object</div>
        <div class="key"><span class="swatch warn"></span> priority return</div>
      </div>
      <div class="hintbar">
        <span>mouse: hover + click</span>
        <span class="small">|</span>
        <span>space: toggle drift</span>
      </div>
    </div>
  </div>

  <script type="module">
    import * as THREE from "https://unpkg.com/three@0.161.0/build/three.module.js";

    // routes (all asteroids go to one of these two)
    const ROUTES = {
      clicker: "../Clicker game/index.html",
      asteroid: "../Asteroid_game/index.html"
    };

    // ui clock
    const clockEl = document.getElementById("clock");
    function tickClock(){
      const d = new Date();
      const hh = String(d.getHours()).padStart(2,"0");
      const mm = String(d.getMinutes()).padStart(2,"0");
      const ss = String(d.getSeconds()).padStart(2,"0");
      clockEl.textContent = `${hh}:${mm}:${ss}`;
      requestAnimationFrame(tickClock);
    }
    tickClock();

    // three setup
    const canvas = document.getElementById("c");
    const stage = document.getElementById("stage");
    const renderer = new THREE.WebGLRenderer({ canvas, antialias:true, alpha:true });
    renderer.setPixelRatio(Math.min(devicePixelRatio, 2));

    const scene = new THREE.Scene();
    scene.fog = new THREE.Fog(0x05070b, 10, 60);

    const camera = new THREE.PerspectiveCamera(45, 1, 0.1, 200);
    camera.position.set(0, 6.5, 16);

    const lightA = new THREE.DirectionalLight(0xbfdcff, 1.2);
    lightA.position.set(8, 10, 6);
    scene.add(lightA);

    const lightB = new THREE.PointLight(0xffcaa0, 0.55, 40);
    lightB.position.set(-10, -2, -8);
    scene.add(lightB);

    scene.add(new THREE.AmbientLight(0x6e89b6, 0.28));

    function resize(){
      const w = stage.clientWidth;
      const h = stage.clientHeight;
      renderer.setSize(w, h, false);
      camera.aspect = w / h;
      camera.updateProjectionMatrix();
    }
    addEventListener("resize", resize, { passive:true });
    resize();

    // stars
    {
      const starCount = 1200;
      const pos = new Float32Array(starCount * 3);
      for(let i=0;i<starCount;i++){
        const r = 40 + Math.random()*60;
        const t = Math.random()*Math.PI*2;
        const p = Math.acos(2*Math.random()-1);
        pos[i*3+0] = r * Math.sin(p) * Math.cos(t);
        pos[i*3+1] = r * Math.cos(p);
        pos[i*3+2] = r * Math.sin(p) * Math.sin(t);
      }
      const g = new THREE.BufferGeometry();
      g.setAttribute("position", new THREE.BufferAttribute(pos, 3));
      const m = new THREE.PointsMaterial({ size:0.03, color:0xa8c8ff, transparent:true, opacity:0.85 });
      scene.add(new THREE.Points(g, m));
    }

    // earth texture (procedural)
    function makeEarthTexture(){
      const c = document.createElement("canvas");
      c.width = 512; c.height = 256;
      const ctx = c.getContext("2d");

      ctx.fillStyle = "#0b2242";
      ctx.fillRect(0,0,c.width,c.height);

      const img = ctx.getImageData(0,0,c.width,c.height);
      for(let i=0;i<img.data.length;i+=4){
        const n = (Math.random()*18)|0;
        img.data[i+0] += n;
        img.data[i+1] += n;
        img.data[i+2] += n;
        img.data[i+3] = 255;
      }
      ctx.putImageData(img,0,0);

      ctx.globalAlpha = 0.9;
      ctx.fillStyle = "#2a7d5a";
      for(let i=0;i<120;i++){
        const x = Math.random()*c.width;
        const y = Math.random()*c.height;
        const r = 6 + Math.random()*26;
        ctx.beginPath();
        ctx.ellipse(x,y, r*(0.6+Math.random()), r*(0.6+Math.random()), Math.random()*Math.PI, 0, Math.PI*2);
        ctx.fill();
      }

      ctx.globalAlpha = 0.7;
      ctx.fillStyle = "#bfe7ff";
      ctx.beginPath(); ctx.ellipse(c.width*0.5, 16, 260, 40, 0, 0, Math.PI*2); ctx.fill();
      ctx.beginPath(); ctx.ellipse(c.width*0.5, c.height-16, 260, 40, 0, 0, Math.PI*2); ctx.fill();

      return new THREE.CanvasTexture(c);
    }

    const earthGroup = new THREE.Group();
    scene.add(earthGroup);

    const earthGeo = new THREE.SphereGeometry(3.2, 48, 48);
    const earthMat = new THREE.MeshStandardMaterial({
      map: makeEarthTexture(),
      roughness: 1.0,
      metalness: 0.0,
      emissive: new THREE.Color(0x0b1a2f),
      emissiveIntensity: 0.25
    });
    const earth = new THREE.Mesh(earthGeo, earthMat);
    earthGroup.add(earth);

    const atmoGeo = new THREE.SphereGeometry(3.33, 36, 36);
    const atmoMat = new THREE.MeshBasicMaterial({
      color: 0x7fb9ff,
      transparent: true,
      opacity: 0.12
    });
    const atmo = new THREE.Mesh(atmoGeo, atmoMat);
    earthGroup.add(atmo);

    // asteroids + interaction
    const raycaster = new THREE.Raycaster();
    const mouse = new THREE.Vector2(999,999);

    const hoverCard = document.getElementById("hoverCard");
    const hoverName = document.getElementById("hoverName");
    const hoverMeta = document.getElementById("hoverMeta");
    const kpiObjects = document.getElementById("kpiObjects");
    const kpiLock = document.getElementById("kpiLock");
    const objectList = document.getElementById("objectList");

    const asteroids = [];
    const asteroidGroup = new THREE.Group();
    scene.add(asteroidGroup);

    function seededNoise(v, seed){
      return Math.sin(v*1.7 + seed)*0.5 + Math.sin(v*3.1 + seed*2.0)*0.35 + Math.sin(v*5.3 + seed*3.0)*0.15;
    }

    function makeAsteroidGeometry(seed){
      const g = new THREE.IcosahedronGeometry(0.35, 1);
      const pos = g.attributes.position;
      for(let i=0;i<pos.count;i++){
        const x = pos.getX(i), y = pos.getY(i), z = pos.getZ(i);
        const r = Math.sqrt(x*x+y*y+z*z) || 1;
        const t = (x+y+z) * 2.0;
        const wobble = 0.18 * seededNoise(t, seed);
        const nx = (x/r) * (1 + wobble);
        const ny = (y/r) * (1 + wobble);
        const nz = (z/r) * (1 + wobble);
        pos.setXYZ(i, nx*r, ny*r, nz*r);
      }
      pos.needsUpdate = true;
      g.computeVertexNormals();
      return g;
    }

    function addAsteroid(i){
      const priority = Math.random() < 0.22;

      const mat = new THREE.MeshStandardMaterial({
        color: priority ? 0xffb27a : 0x9cc6ff,
        roughness: 0.95,
        metalness: 0.0,
        emissive: new THREE.Color(priority ? 0x2a1208 : 0x08101c),
        emissiveIntensity: 0.25
      });

      const mesh = new THREE.Mesh(makeAsteroidGeometry(i*17.7), mat);

      // route assignment: all asteroids go to either clicker or asteroid
      const routeKey = i % 2 === 0 ? "clicker" : "asteroid";

      mesh.userData = {
        id: `neo-${String(i+1).padStart(3,"0")}`,
        priority,
        route: routeKey,
        page: ROUTES[routeKey],
        orbitR: 5.6 + Math.random()*2.7,
        orbitSpeed: 0.22 + Math.random()*0.35,
        orbitPhase: Math.random()*Math.PI*2,
        tilt: (Math.random()*0.9 - 0.45),
        spin: 0.6 + Math.random()*1.4,
        relv: (12 + Math.random()*28).toFixed(1),
        miss: (0.8 + Math.random()*5.8).toFixed(2)
      };

      const halo = new THREE.Mesh(
        new THREE.SphereGeometry(0.62, 18, 18),
        new THREE.MeshBasicMaterial({ color: priority ? 0xffb27a : 0x7fb9ff, transparent:true, opacity:0.0 })
      );
      mesh.add(halo);
      mesh.userData.halo = halo;

      asteroidGroup.add(mesh);
      asteroids.push(mesh);
    }

    const ASTEROID_COUNT = 14;
    for(let i=0;i<ASTEROID_COUNT;i++) addAsteroid(i);

    kpiObjects.textContent = String(ASTEROID_COUNT);

    function renderList(){
      objectList.innerHTML = "";
      for(const a of asteroids){
        const row = document.createElement("div");
        row.className = "row";

        const left = document.createElement("div");
        left.textContent = a.userData.id;

        const right = document.createElement("div");
        right.className = "badge" + (a.userData.priority ? " warn" : "");
        right.textContent = a.userData.route; // clicker / asteroid

        row.appendChild(left);
        row.appendChild(right);
        objectList.appendChild(row);
      }
    }
    renderList();

    let hovered = null;
    let drift = true;

    addEventListener("mousemove", (e)=>{
      const rect = renderer.domElement.getBoundingClientRect();
      const x = ((e.clientX - rect.left) / rect.width) * 2 - 1;
      const y = -((e.clientY - rect.top) / rect.height) * 2 + 1;
      mouse.set(x,y);
    }, { passive:true });

    addEventListener("click", ()=>{
      if(hovered){
        window.location.href = hovered.userData.page;
      }
    });

    addEventListener("keydown", (e)=>{
      if(e.code === "Space") drift = !drift;
    });

    function setHoverCard(a){
      if(!a){
        hoverCard.classList.remove("show");
        kpiLock.textContent = "none";
        return;
      }

      hoverName.textContent = a.userData.id;
      hoverMeta.innerHTML = "";

      const parts = [
        a.userData.priority ? "priority return" : "tracked return",
        `relative v: ${a.userData.relv} km/s`,
        `miss distance: ${a.userData.miss} ld`,
        `route: ${a.userData.route}`
      ];

      for(const p of parts){
        const s = document.createElement("span");
        s.textContent = p;
        hoverMeta.appendChild(s);
      }

      hoverCard.classList.add("show");
      kpiLock.textContent = a.userData.id;
    }

    let start = performance.now();
    function animate(now){
      const t = (now - start) * 0.001;

      earth.rotation.y = t * 0.18;
      atmo.rotation.y = t * 0.12;

      for(const a of asteroids){
        const u = a.userData;
        const ang = t * u.orbitSpeed + u.orbitPhase;
        const r = u.orbitR + (drift ? Math.sin(t*0.8 + u.orbitPhase)*0.12 : 0.0);

        const x = Math.cos(ang) * r;
        const z = Math.sin(ang) * r;
        const y = Math.sin(ang*0.8) * u.tilt;

        a.position.set(x, y, z);
        a.rotation.x += 0.012 * u.spin;
        a.rotation.y += 0.018 * u.spin;
      }

      raycaster.setFromCamera(mouse, camera);
      const hits = raycaster.intersectObjects(asteroids, true).filter(h => asteroids.includes(h.object));
      const next = hits.length ? hits[0].object : null;

      if(next !== hovered){
        if(hovered){
          hovered.scale.setScalar(1);
          hovered.userData.halo.material.opacity = 0.0;
          hovered.material.emissiveIntensity = 0.25;
        }
        hovered = next;

        if(hovered){
          hovered.scale.setScalar(1.18);
          hovered.userData.halo.material.opacity = 0.35;
          hovered.material.emissiveIntensity = 0.55;
        }

        setHoverCard(hovered);
        document.getElementById("scanState").textContent = hovered ? "lock" : "sweep";
      }

      if(hovered){
        const pulse = 0.06 + Math.sin(t*8.0)*0.03;
        hovered.userData.halo.scale.setScalar(1.0 + pulse);
        hovered.userData.halo.material.opacity = 0.25 + pulse*0.9;
      }

      camera.position.x = Math.sin(t*0.12) * 1.6;
      camera.position.z = 16 + Math.cos(t*0.12) * 0.8;
      camera.lookAt(0, 0, 0);

      renderer.render(scene, camera);
      requestAnimationFrame(animate);
    }
    requestAnimationFrame(animate);
  </script>
</body>
</html>
